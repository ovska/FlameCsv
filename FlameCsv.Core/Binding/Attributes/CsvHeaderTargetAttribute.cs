using CommunityToolkit.Diagnostics;

namespace FlameCsv.Binding.Attributes;

/// <summary>
/// Binds <see cref="MemberName"/> to fields whose header matches with the provided values.
/// Use if <see cref="CsvHeaderAttribute"/> cannot be used on a member directly, e.g. on autogenerated partial classes.
/// </summary>
/// <remarks>
/// Not applicable for constructor parameters. Instead, create another constructor in the partial file with
/// <see cref="CsvConstructorAttribute"/>, and add an unused parameter with <see cref="CsvHeaderExcludeAttribute"/>
/// or change the parameter order.
/// </remarks>
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Struct, AllowMultiple = true)]
public sealed class CsvHeaderTargetAttribute : Attribute
{
    /// <summary>Header values to match.</summary>
    public string[] Values { get; }

    /// <summary>Name of the property or field.</summary>
    public string MemberName { get; }

    /// <inheritdoc cref="CsvHeaderAttribute.Order"/>
    public int Order { get; set; } = 1;

    /// <inheritdoc cref="CsvHeaderAttribute.Required"/>
    public bool IsRequired { get; set; }

    /// <inheritdoc cref="CsvHeaderTargetAttribute"/>
    /// <param name="memberName">Name of the property or field</param>
    /// <param name="values">Header fields value(s)</param>
    public CsvHeaderTargetAttribute(
        string memberName,
        params string[] values)
    {
        Guard.IsNotNullOrWhiteSpace(memberName);
        Guard.IsNotNull(values);
        Values = values;
        MemberName = memberName;
    }
}
